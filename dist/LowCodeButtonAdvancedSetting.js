var LCB;(()=>{"use strict";var e={};({25:function(e,t){var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function l(e){try{s(i.next(e))}catch(e){r(e)}}function a(e){try{s(i.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,a)}s((i=i.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=a(0),l.throw=a(1),l.return=a(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function a(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,a[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnSaveLogic=t.FormLogic=void 0;var o=function(){function e(){}return e.toggleDialogSection=function(e){var t=e.getFormContext(),n=t.getAttribute("esp_showconfirmationdialog");if(n){var i=n.getValue(),o=t.ui.tabs.get("general");if(o){var r=o.sections.get("confirmation_dialog");r&&(i?r.setVisible(!0):r.setVisible(!1))}}},e.toggleSyncSection=function(e){var t=e.getFormContext(),n=t.getAttribute("esp_executionmode");if(n){var i=n.getValue(),o=t.ui.tabs.get("general");if(o){var r=o.sections.get("sync_settings");if(r){var l=o.sections.get("async_settings");l&&(0==i?(r.setVisible(!0),l.setVisible(!1)):(l.setVisible(!0),r.setVisible(!1)))}}}},e.toggleBoxSection=function(e){var t=e.getFormContext(),n=t.getAttribute("esp_syncconfirmationboxtype");if(n){var i=n.getValue(),o=t.ui.tabs.get("general");if(o){var r=o.sections.get("sync_confirmation_box");if(r){var l=o.sections.get("sync_confirmation_redirect");l&&(0==i?(r.setVisible(!0),l.setVisible(!1)):1==i?(l.setVisible(!0),r.setVisible(!1)):(l.setVisible(!1),r.setVisible(!1)))}}}},e.onLoad=function(t){e.toggleDialogSection(t),e.toggleSyncSection(t),e.toggleBoxSection(t)},e.onChange=function(t){e.toggleDialogSection(t),e.toggleSyncSection(t),e.toggleBoxSection(t)},e}();t.FormLogic=o;var r=function(){function e(){}return e.onSaveDialogSection=function(e){return n(this,void 0,void 0,(function(){var t,n,o,r,l,a,s,c,u,f,p,g,d,_,b,m,S,y,v,x,C,h,B,A,V,T;return i(this,(function(i){switch(i.label){case 0:if(t=e.getFormContext(),n=t.getAttribute("esp_showconfirmationdialog"),o=t.getAttribute("esp_mainbuttonsetting"),!n||!o)return[2];if(r=n.getValue(),l=o.getValue(),!1===r&&(null===(h=t.getAttribute("esp_confirmationdialogtitle"))||void 0===h||h.setValue(null),null===(B=t.getAttribute("esp_confirmationdialogtext"))||void 0===B||B.setValue(null),null===(A=t.getAttribute("esp_confirmationdialogsubtitle"))||void 0===A||A.setValue(null),null===(V=t.getAttribute("esp_confirmationdialogcancellabel"))||void 0===V||V.setValue(null),null===(T=t.getAttribute("esp_confirmationdialogconfirmlabel"))||void 0===T||T.setValue(null)),!l||0===l.length||!l[0].id)return[2];a=l[0].id.replace(/[{}]/g,""),s="_$esp_mainbuttonsetting_value eq ".concat(a),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,Xrm.WebApi.retrieveMultipleRecords("esp_buttonadvancedsetting","?$select=esp_ConfirmationDialogTitle,esp_ConfirmationDialogText,esp_ConfirmationDialogSubtitle,esp_ConfirmationDialogCancelLabel,esp_ConfirmationDialogConfirmLabel,esp_ShowConfirmationDialog,esp_ConfirmationDialogFlag&$filter=".concat(s))];case 2:if(!(c=i.sent())||!c.entities||0===c.entities.length)return[2];for(u=[],f=0,p=c.entities;f<p.length;f++)g=p[f],(d=g.esp_buttonadvancedsettingid||g.esp_ButtonAdvancedSettingId||g.esp_buttonadvancedsettingId)&&(_=null,!1===r?_={esp_confirmationdialogtitle:null,esp_confirmationdialogtext:null,esp_confirmationdialogsubtitle:null,esp_confirmationdialogcancelLabel:null,esp_confirmationdialogconfirmLabel:null}:!0===r&&(b=g.esp_confirmationdialogtitle,m=g.esp_confirmationdialogtext,S=g.esp_confirmationdialogsubtitle,y=g.esp_confirmationdialogcancellabel,v=g.esp_confirmationdialogconfirmlabel,!(b&&m&&S&&y&&v)&&(_={esp_modificationneededflag:!0})),_&&(x=Xrm.WebApi.updateRecord("esp_buttonadvancedsetting",d,_),u.push(x)));return u.length>0?[4,Promise.all(u)]:[3,4];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return C=i.sent(),console.error("Error in OnSaveLogic for dialog:",C),[3,6];case 6:return[2]}}))}))},e.onSaveSyncSections=function(e){return n(this,void 0,void 0,(function(){var t,n,o,r,l,a,s,c,u,f,p,g,d,_,b,m,S,y,v,x,C,h,B,A,V,T,F;return i(this,(function(i){switch(i.label){case 0:if(t=e.getFormContext(),n=t.getAttribute("esp_ExecutionMode"),o=t.getAttribute("esp_MainButtonSetting"),!n||!o)return[2];if(r=n.getValue(),l=o.getValue(),0===r?(null===(C=t.getAttribute("esp_AsyncFormNotificationText"))||void 0===C||C.setValue(null),null===(h=t.getAttribute("esp_AsyncFormNotification"))||void 0===h||h.setValue(!1)):1===r&&(null===(B=t.getAttribute("esp_SyncFormNotificationText"))||void 0===B||B.setValue(null),null===(A=t.getAttribute("esp_SyncFormNotification"))||void 0===A||A.setValue(!1),null===(V=t.getAttribute("esp_SyncSpinnerText"))||void 0===V||V.setValue(null),null===(T=t.getAttribute("esp_SyncSuccessFormNotificationText"))||void 0===T||T.setValue(null),null===(F=t.getAttribute("esp_SyncConfirmationBoxType"))||void 0===F||F.setValue(null)),!l||0===l.length||!l[0].id)return[2];a=l[0].id.replace(/[{}]/g,""),s="_$esp_mainbuttonsetting_value eq ".concat(a),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,Xrm.WebApi.retrieveMultipleRecords("esp_buttonadvancedsetting","?$select=esp_AsyncFormNotificationText,esp_SyncFormNotificationText,esp_SyncSpinnerText,esp_SyncSuccessFormNotificationText,esp_SyncConfirmationBoxType,esp_ConfirmationDialogFlag&$filter=".concat(s))];case 2:if(!(c=i.sent())||!c.entities||0===c.entities.length)return[2];for(u=[],f=0,p=c.entities;f<p.length;f++)g=p[f],(d=g.esp_buttonadvancedsettingid||g.esp_ButtonAdvancedSettingId||g.esp_buttonadvancedsettingId)&&(_=null,0===r?(_={esp_SyncConfirmationBoxType:null,esp_SyncFormNotificationText:null,esp_SyncFormNotification:!1,esp_SyncSpinnerText:null,esp_SyncSuccessFormNotificationText:null},!(m=g.esp_AsyncFormNotificationText)&&(_.esp_ModificationNeededFlag=!0)):1===r&&(_={esp_AsyncFormNotificationText:null,esp_AsyncFormNotification:!1},b=g.esp_SyncConfirmationBoxType,m=g.esp_SyncFormNotificationText,S=g.esp_SyncSpinnerText,y=g.esp_SyncSuccessFormNotificationText,!(b&&m&&S&&y)&&(_.esp_ModificationNeededFlag=!0)),_&&(v=Xrm.WebApi.updateRecord("esp_buttonadvancedsetting",d,_),u.push(v)));return u.length>0?[4,Promise.all(u)]:[3,4];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return x=i.sent(),console.error("Error in OnSaveLogic for sync/async:",x),[3,6];case 6:return[2]}}))}))},e.onSaveBoxSections=function(e){return n(this,void 0,void 0,(function(){var t,n,o,r,l,a,s,c,u,f,p,g,d,_,b,m,S,y,v,x,C,h,B,A,V,T,F,L,R,N,w,D;return i(this,(function(i){switch(i.label){case 0:if(t=e.getFormContext(),n=t.getAttribute("esp_SyncConfirmationBoxType"),o=t.getAttribute("esp_MainButtonSetting"),!n||!o)return[2];if(r=n.getValue(),l=o.getValue(),0===r?(null===(V=t.getAttribute("esp_SyncConfirmationBoxRedirectCancelLabel"))||void 0===V||V.setValue(null),null===(T=t.getAttribute("esp_SyncConfirmationBoxRedirectConfirmLabel"))||void 0===T||T.setValue(null),null===(F=t.getAttribute("esp_SyncConfirmationBoxRedirectSubtitle"))||void 0===F||F.setValue(null),null===(L=t.getAttribute("esp_SyncConfirmationBoxRedirectText"))||void 0===L||L.setValue(null),null===(R=t.getAttribute("esp_SyncConfirmationBoxRedirectTitle"))||void 0===R||R.setValue(null)):1===r&&(null===(N=t.getAttribute("esp_SyncConfirmationBoxConfirmLabel"))||void 0===N||N.setValue(null),null===(w=t.getAttribute("esp_SyncConfirmationBoxText"))||void 0===w||w.setValue(null),null===(D=t.getAttribute("esp_SyncConfirmationBoxTitle"))||void 0===D||D.setValue(null)),!l||0===l.length||!l[0].id)return[2];a=l[0].id.replace(/[{}]/g,""),s="_$esp_mainbuttonsetting_value eq ".concat(a),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,Xrm.WebApi.retrieveMultipleRecords("esp_buttonadvancedsetting","?$select=esp_SyncConfirmationBoxTitle,esp_SyncConfirmationBoxText,esp_SyncConfirmationBoxConfirmLabel,esp_SyncConfirmationBoxRedirectTitle,esp_SyncConfirmationBoxRedirectText,esp_SyncConfirmationBoxRedirectSubtitle,esp_SyncConfirmationBoxRedirectCancelLabel,esp_SyncConfirmationBoxRedirectConfirmLabel&$filter=".concat(s))];case 2:if(!(c=i.sent())||!c.entities||0===c.entities.length)return[2];for(u=[],f=0,p=c.entities;f<p.length;f++)g=p[f],(d=g.esp_buttonadvancedsettingid||g.esp_ButtonAdvancedSettingId||g.esp_buttonadvancedsettingId)&&(_=null,0===r?(_={esp_SyncConfirmationBoxRedirectCancelLabel:null,esp_SyncConfirmationBoxRedirectConfirmLabel:null,esp_SyncConfirmationBoxRedirectSubtitle:null,esp_SyncConfirmationBoxRedirectText:null,esp_SyncConfirmationBoxRedirectTitle:null},b=g.esp_SyncConfirmationBoxTitle,m=g.esp_SyncConfirmationBoxText,S=g.esp_SyncConfirmationBoxConfirmLabel,b&&m&&S||(_.esp_ModificationNeededFlag=!0)):1===r&&(_={esp_SyncConfirmationBoxTitle:null,esp_SyncConfirmationBoxText:null,esp_SyncConfirmationBoxConfirmLabel:null},y=g.esp_SyncConfirmationBoxRedirectCancelLabel,v=g.esp_SyncConfirmationBoxRedirectConfirmLabel,x=g.esp_SyncConfirmationBoxRedirectSubtitle,C=g.esp_SyncConfirmationBoxRedirectText,h=g.esp_SyncConfirmationBoxRedirectTitle,!(y&&v&&x&&C&&h)&&(_.esp_ModificationNeededFlag=!0)),_&&(B=Xrm.WebApi.updateRecord("esp_buttonadvancedsetting",d,_),u.push(B)));return u.length>0?[4,Promise.all(u)]:[3,4];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return A=i.sent(),console.error("Error in OnSaveLogic for sync/async:",A),[3,6];case 6:return[2]}}))}))},e.onSave=function(t){e.onSaveDialogSection(t),e.onSaveBoxSections(t),e.onSaveSyncSections(t)},e}();t.OnSaveLogic=r}})[25](0,e),LCB=e})();