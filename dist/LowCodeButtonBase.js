var LCB;(()=>{"use strict";var t={331:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorMessageResponse=e.RedirectResponse=void 0;var o=n(601),i=function(){function t(t){this.redirectUri=t}return t.fromJson=function(e){var n=JSON.parse(e);if("string"!=typeof n.redirectUri)throw o.ExceptionLowCodeButton.showFormNotificationGenericError("Redirect URI Not Found","The redirect URI was not found in the response."),new Error("Invalid JSON format for RedirectResponse");return new t(n.redirectUri)},t}();e.RedirectResponse=i;var r=function(){function t(t,e){this.message=t,this.title=e}return t.fromJson=function(e){var n,i=JSON.parse(e);if(console.log("Error message data",i),"string"!=typeof i.message)throw o.ExceptionLowCodeButton.showFormNotificationGenericError("Error Message Not Found","The error message was not found in the response."),new Error("Invalid JSON format for ErrorMessage");return new t(i.message,null!==(n=i.title)&&void 0!==n?n:"")},t}();e.ErrorMessageResponse=r},525:function(t,e,n){var o=this&&this.__assign||function(){return o=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)},i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function a(t){try{s(o.next(t))}catch(t){r(t)}}function c(t){try{s(o.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}s((o=o.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&c[0]?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,o=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(6===c[0]&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(t){c=[6,t],o=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonHelper=void 0;var a=n(601),c=function(){function t(t,e,n){this.formContext=t,this.buttonSetting=e,this.buttonAdvancedSetting=n}return t.prototype.setFormContext=function(t){this.formContext=t},t.prototype.setButtonSetting=function(t){this.buttonSetting=t},t.prototype.setButtonAdvancedSetting=function(t){this.buttonAdvancedSetting=t},t.prototype.getLanguageCode=function(){return Xrm.Utility.getGlobalContext().userSettings.languageId},t.prototype.getUserID=function(){return Xrm.Utility.getGlobalContext().userSettings.userId.replace("{","").replace("}","").toLowerCase()},t.prototype.getEntityLogicalName=function(){if(!this.formContext)throw new Error("Form context is not set.");return this.formContext.data.entity.getEntityName()},t.prototype.getRecordId=function(){if(!this.formContext)throw new Error("Form context is not set.");return this.formContext.data.entity.getId().replace("{","").replace("}","").toLowerCase()},t.prototype.getButtonSetting=function(t){return i(this,void 0,void 0,(function(){var e,n,o,i,a,c;return r(this,(function(r){switch(r.label){case 0:e='\n      <fetch top="1">\n        <entity name="esp_buttonsetting">\n          <attribute name="esp_buttonsettingid" />\n          <attribute name="esp_endpoint" />\n          <attribute name="esp_includecallinguseridinpayload" />\n          <attribute name="esp_includeentitylogicalnameinpayload" />\n          <attribute name="esp_includerecordidinpayload" />\n          <attribute name="esp_buttonname" />\n          <attribute name="esp_savebeforerunning" />\n          <attribute name="esp_refreshformwhenapicallends" />\n          <filter type="and">\n            <condition attribute="esp_buttonname" operator="eq" value="'.concat(t,'" />\n          </filter>\n        </entity>\n      </fetch>\n    '),n="?fetchXml=".concat(encodeURIComponent(e)),o="".concat(Xrm.Utility.getGlobalContext().getClientUrl(),"/api/data/v9.1/esp_buttonsettings").concat(n),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this.makeRequest("GET",o)];case 2:return[4,r.sent().json()];case 3:return i=r.sent(),a=i.value[0],this.buttonSetting=a,[2,a];case 4:return c=r.sent(),console.error("Error fetching button setting:",c),[2,null];case 5:return[2]}}))}))},t.prototype.getButtonAdvancedSetting=function(t,e){return i(this,void 0,void 0,(function(){var n,o,i,a,c,s;return r(this,(function(r){switch(r.label){case 0:n='\n      <fetch top="1">\n        <entity name="esp_buttonadvancedsetting">\n          <attribute name="esp_asyncformnotification" />\n          <attribute name="esp_asyncformnotificationtext" />\n          <attribute name="esp_buttonadvancedsettingid" />\n          <attribute name="esp_confirmationdialogcancellabel" />\n          <attribute name="esp_confirmationdialogconfirmlabel" />\n          <attribute name="esp_confirmationdialogsubtitle" />\n          <attribute name="esp_confirmationdialogtext" />\n          <attribute name="esp_confirmationdialogtitle" />\n          <attribute name="esp_executionmode" />\n          <attribute name="esp_mainbuttonsetting" />\n          <attribute name="esp_settingid" />\n          <attribute name="esp_settinglanguage" />\n          <attribute name="esp_showconfirmationdialog" />\n          <attribute name="esp_syncconfirmationbox" />\n          <attribute name="esp_syncconfirmationboxconfirmlabel" />\n          <attribute name="esp_syncconfirmationboxredirect" />\n          <attribute name="esp_syncconfirmationboxredirectcancellabel" />\n          <attribute name="esp_syncconfirmationboxredirectconfirmlabel" />\n          <attribute name="esp_syncconfirmationboxredirectmode" />\n          <attribute name="esp_syncconfirmationboxredirectsubtitle" />\n          <attribute name="esp_syncconfirmationboxredirecttext" />\n          <attribute name="esp_syncconfirmationboxredirecttitle" />\n          <attribute name="esp_syncconfirmationboxtext" />\n          <attribute name="esp_syncconfirmationboxtitle" />\n          <attribute name="esp_syncformnotification" />\n          <attribute name="esp_syncformnotificationtext" />\n          <attribute name="esp_syncrefreshform" />\n          <attribute name="esp_syncspinner" />\n          <attribute name="esp_syncspinnertext" />\n          <attribute name="esp_syncsuccessformnotification" />\n          <attribute name="esp_syncsuccessformnotificationtext" />\n          <filter>\n            <condition attribute="esp_mainbuttonsetting" operator="eq" value="'.concat(t,'" />\n          </filter>\n          <link-entity name="esp_language" from="esp_languageid" to="esp_settinglanguage" link-type="inner">\n            <filter>\n              <condition attribute="esp_lcid" operator="eq" value="').concat(e,'" />\n            </filter>\n          </link-entity>\n        </entity>\n      </fetch>\n    '),o="?fetchXml=".concat(encodeURIComponent(n)),i="".concat(Xrm.Utility.getGlobalContext().getClientUrl(),"/api/data/v9.1/esp_buttonadvancedsettings").concat(o),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this.makeRequest("GET",i)];case 2:return[4,r.sent().json()];case 3:return a=r.sent(),c=a.value[0],this.buttonAdvancedSetting=c,[2,c];case 4:return s=r.sent(),console.error("Error fetching button advanced setting:",s),[2,null];case 5:return[2]}}))}))},t.prototype.getPayload=function(){if(!this.formContext||!this.buttonSetting)throw new Error("Form context or button setting is not set.");var t={};return this.buttonSetting.esp_includeentitylogicalnameinpayload&&(t=o(o({},t),{entityLogicalName:this.getEntityLogicalName()})),this.buttonSetting.esp_includerecordidinpayload&&(t=o(o({},t),{recordId:this.getRecordId()})),this.buttonSetting.esp_includecallinguseridinpayload&&(t=o(o({},t),{userId:this.getUserID()})),t},t.prototype.makeRequest=function(t,e,n){return i(this,void 0,void 0,(function(){var o;return r(this,(function(i){return o={method:t,headers:{"Content-Type":"application/json","OData-MaxVersion":"4.0","OData-Version":"4.0",Accept:"application/json",Prefer:"odata.include-annotations=*"},body:n?JSON.stringify(n):void 0},[2,fetch(e,o)]}))}))},t.prototype.openConfirmationDialogBeforeRun=function(){return i(this,void 0,void 0,(function(){var t,e,n,o,i;return r(this,(function(r){switch(r.label){case 0:return this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_confirmationdialogtext?[3,2]:[4,a.ExceptionLowCodeButton.showFormNotificationGenericError("Confirmation Dialog Text Error","The confirmation dialog text is empty! Please fill it on your configuration settings.")];case 1:return r.sent(),[2,!1];case 2:return t={cancelButtonLabel:null!==(e=this.buttonAdvancedSetting.esp_confirmationdialogcancellabel)&&void 0!==e?e:"",confirmButtonLabel:null!==(n=this.buttonAdvancedSetting.esp_confirmationdialogconfirmlabel)&&void 0!==n?n:"",subtitle:null!==(o=this.buttonAdvancedSetting.esp_confirmationdialogsubtitle)&&void 0!==o?o:"",text:null!==(i=this.buttonAdvancedSetting.esp_confirmationdialogtext)&&void 0!==i?i:"",title:this.buttonAdvancedSetting.esp_confirmationdialogtitle},[4,Xrm.Navigation.openConfirmDialog(t)];case 3:return[2,r.sent().confirmed]}}))}))},t.prototype.openSuccessDialogSync=function(){return i(this,void 0,void 0,(function(){var t,e,n;return r(this,(function(o){switch(o.label){case 0:return this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_syncconfirmationboxtext?[3,2]:[4,a.ExceptionLowCodeButton.showFormNotificationGenericError("Sync Confirmation Box Text Error","The sync confirmation box text is empty! Please fill it on your configuration settings.")];case 1:return o.sent(),[2,!1];case 2:return t={confirmButtonLabel:null!==(e=this.buttonAdvancedSetting.esp_syncconfirmationboxconfirmlabel)&&void 0!==e?e:void 0,text:null!==(n=this.buttonAdvancedSetting.esp_syncconfirmationboxtext)&&void 0!==n?n:void 0,title:this.buttonAdvancedSetting.esp_syncconfirmationboxtitle},[4,Xrm.Navigation.openAlertDialog(t)];case 3:return[2,o.sent().confirmed]}}))}))},t.prototype.openSuccessDialogRedirect=function(t){var e,n,o,i,r=this;if(!this.buttonAdvancedSetting)throw new Error("Button advanced setting is not set.");if(null!=this.buttonAdvancedSetting.esp_syncconfirmationboxredirecttext){var c={cancelButtonLabel:null!==(e=this.buttonAdvancedSetting.esp_syncconfirmationboxredirectcancellabel)&&void 0!==e?e:void 0,confirmButtonLabel:null!==(n=this.buttonAdvancedSetting.esp_syncconfirmationboxredirectconfirmlabel)&&void 0!==n?n:void 0,text:this.buttonAdvancedSetting.esp_syncconfirmationboxredirecttext,subtitle:null!==(o=this.buttonAdvancedSetting.esp_syncconfirmationboxredirectsubtitle)&&void 0!==o?o:void 0,title:null!==(i=this.buttonAdvancedSetting.esp_syncconfirmationboxredirecttitle)&&void 0!==i?i:void 0};Xrm.Navigation.openConfirmDialog(c).then((function(e){e.confirmed?(console.log("User confirmed the dialog, redirecting..."),1===r.buttonAdvancedSetting.esp_syncconfirmationboxredirectmode?window.open(t.redirectUri,"_self").focus():window.open(t.redirectUri,"_blank").focus()):(console.log("User cancelled the dialog, refreshing the form."),r.reloadForm())}))}else a.ExceptionLowCodeButton.showFormNotificationGenericError("Sync Confirmation Box Redirect Text Error","The sync confirmation box redirect text is empty! Please fill it on your configuration settings.")},t.prototype.reloadForm=function(){if(!this.formContext||!this.buttonSetting||!this.buttonAdvancedSetting)throw new Error("Required properties are not set for reloading the form.");!this.buttonSetting.esp_refreshformwhenapicallends||this.buttonAdvancedSetting.esp_syncconfirmationboxredirect&&1===this.buttonAdvancedSetting.esp_syncconfirmationboxredirectmode||this.formContext.data.refresh(!1)},t.prototype.asyncFormNotification=function(){return i(this,void 0,void 0,(function(){var t=this;return r(this,(function(e){switch(e.label){case 0:return this.formContext&&this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_asyncformnotificationtext?[3,2]:[4,a.ExceptionLowCodeButton.showFormNotificationGenericError("Async Form Notification Text Error","The async form notification text is empty! Please fill it on your configuration settings.")];case 1:return e.sent(),[2];case 2:return this.formContext.ui.setFormNotification(this.buttonAdvancedSetting.esp_asyncformnotificationtext,"INFO","LowCodeButtonFormNotification"),setTimeout((function(){t.formContext.ui.clearFormNotification("LowCodeButtonFormNotification")}),5e3),[2]}}))}))},t.prototype.clearFormNotification=function(){if(!this.formContext)throw new Error("Form context is not set.");this.formContext.ui.clearFormNotification("LowCodeButtonFormNotification")},t.prototype.syncFormNotification=function(){return i(this,void 0,void 0,(function(){var t=this;return r(this,(function(e){switch(e.label){case 0:return this.formContext&&this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_syncformnotificationtext?[3,2]:[4,a.ExceptionLowCodeButton.showFormNotificationGenericError("Sync Form Notification Text Error","The sync form notification text is empty! Please fill it on your configuration settings.")];case 1:return e.sent(),[2];case 2:return this.formContext.ui.setFormNotification(this.buttonAdvancedSetting.esp_syncformnotificationtext,"INFO","LowCodeButtonFormNotification"),setTimeout((function(){t.formContext.ui.clearFormNotification("LowCodeButtonFormNotification")}),12e4),[2]}}))}))},t.prototype.showSuccessFormNotification=function(){return i(this,void 0,void 0,(function(){var t=this;return r(this,(function(e){switch(e.label){case 0:return this.formContext&&this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_syncsuccessformnotificationtext?[3,2]:[4,a.ExceptionLowCodeButton.showFormNotificationGenericError("Success Form Notification Text Error","The success form notification text is empty! Please fill it on your configuration settings.")];case 1:return e.sent(),[2];case 2:return this.formContext.ui.setFormNotification(this.buttonAdvancedSetting.esp_syncsuccessformnotificationtext,"INFO","LowCodeButtonFormNotification"),setTimeout((function(){t.formContext.ui.clearFormNotification("LowCodeButtonFormNotification")}),5e3),[2]}}))}))},t.prototype.clearSyncNotifications=function(){var t,e;(null===(t=this.buttonAdvancedSetting)||void 0===t?void 0:t.esp_syncformnotification)&&this.clearFormNotification(),(null===(e=this.buttonAdvancedSetting)||void 0===e?void 0:e.esp_syncspinner)&&Xrm.Utility.closeProgressIndicator()},t}();e.ButtonHelper=c},601:function(t,e){var n=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function a(t){try{s(o.next(t))}catch(t){r(t)}}function c(t){try{s(o.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}s((o=o.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&c[0]?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,o=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(6===c[0]&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(t){c=[6,t],o=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ExceptionLowCodeButton=void 0;var i=function(){function t(){}return t.buttonSettingNotFound=function(t){return n(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e={text:"Button setting not found: ".concat(t),title:"Button Setting Not Found"},[4,Xrm.Navigation.openAlertDialog(e)];case 1:return n.sent(),[2]}}))}))},t.buttonAdvancedSettingNotFound=function(t){return n(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return e={text:"Button advanced setting not found for the LCID ".concat(t),title:"Button Advanced Setting Not Found"},[4,Xrm.Navigation.openAlertDialog(e)];case 1:return n.sent(),[2]}}))}))},t.showFormNotificationGenericError=function(t,e){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:return n={text:e,title:t},[4,Xrm.Navigation.openAlertDialog(n)];case 1:return o.sent(),[2]}}))}))},t}();e.ExceptionLowCodeButton=i},698:function(t,e,n){var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(i,r){function a(t){try{s(o.next(t))}catch(t){r(t)}}function c(t){try{s(o.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}s((o=o.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&c[0]?o.return:c[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,c[1])).done)return i;switch(o=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,o=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(6===c[0]&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(t){c=[6,t],o=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonRegistration=void 0;var r=n(601),a=n(525),c=n(331),s=function(){function t(){}return t.determineContext=function(t){return t.data?(alert("The control is on a main form."),"form"):t.getGrid?t.getParent&&t.getParent()?(alert("The control is on a subgrid."),"subgrid"):(alert("The control is on a main grid."),"grid"):(alert("Unknown context."),"unknown")},t.onClick=function(t,e){return o(this,void 0,void 0,(function(){var n,o,c,s,u;return i(this,(function(i){switch(i.label){case 0:return n=new a.ButtonHelper(t),o=n.getLanguageCode(),[4,n.getButtonSetting(e)];case 1:return(c=i.sent())?[4,n.getButtonAdvancedSetting(null!==(u=c.esp_buttonsettingid)&&void 0!==u?u:"",o)]:(r.ExceptionLowCodeButton.buttonSettingNotFound(e),[2]);case 2:return(s=i.sent())?[3,4]:[4,r.ExceptionLowCodeButton.buttonAdvancedSettingNotFound(o)];case 3:return i.sent(),[2];case 4:return s.esp_showconfirmationdialog?[4,n.openConfirmationDialogBeforeRun()]:[3,6];case 5:if(!i.sent())return[2];i.label=6;case 6:return t.data.entity.getIsDirty()&&c.esp_savebeforerunning?(console.log("Saving form before running the button"),[4,t.data.save()]):[3,8];case 7:i.sent(),i.label=8;case 8:return c.esp_endpoint?[3,10]:[4,r.ExceptionLowCodeButton.showFormNotificationGenericError("Endpoint Not Set","The endpoint for the button is not set. Please set it up in the button settings.")];case 9:return i.sent(),[2];case 10:return 1!==s.esp_executionmode?[3,12]:[4,this.executeAsync(n)];case 11:return i.sent(),[3,14];case 12:return[4,this.executeSync(n)];case 13:i.sent(),i.label=14;case 14:return[2]}}))}))},t.executeAsync=function(t){return o(this,void 0,void 0,(function(){var e,n,a=this;return i(this,(function(c){switch(c.label){case 0:return e=t.buttonSetting,n=t.buttonAdvancedSetting,console.log("Executing async call to ".concat(null==e?void 0:e.esp_endpoint)),(null==n?void 0:n.esp_asyncformnotification)?[4,t.asyncFormNotification()]:[3,2];case 1:c.sent(),c.label=2;case 2:return t.makeRequest("POST",e.esp_endpoint,t.getPayload()).catch((function(e){return o(a,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return[4,r.ExceptionLowCodeButton.showFormNotificationGenericError("Error during HTTP Call",e.message)];case 1:return n.sent(),[4,t.clearFormNotification()];case 2:return n.sent(),[2]}}))}))})),[2]}}))}))},t.executeSync=function(t){return o(this,void 0,void 0,(function(){var e,n,a,s,u,l,f,d,p,m,h,b,g=this;return i(this,(function(y){switch(y.label){case 0:return e=t.buttonSetting,n=t.buttonAdvancedSetting,console.log("Executing sync call to ".concat(null==e?void 0:e.esp_endpoint)),(null==n?void 0:n.esp_syncformnotification)?[4,t.syncFormNotification()]:[3,2];case 1:y.sent(),y.label=2;case 2:return(null==n?void 0:n.esp_syncspinner)?n.esp_syncspinnertext?[3,4]:[4,r.ExceptionLowCodeButton.showFormNotificationGenericError("Sync Spinner Text Error","The sync spinner text is empty! Please fill it on your configuration settings.")]:[3,5];case 3:return y.sent(),[2];case 4:Xrm.Utility.showProgressIndicator(n.esp_syncspinnertext),y.label=5;case 5:return[4,t.makeRequest("POST",e.esp_endpoint,t.getPayload()).catch((function(t){return o(g,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,r.ExceptionLowCodeButton.showFormNotificationGenericError("Error during HTTP Call",t.message)];case 1:return e.sent(),[2]}}))}))})).finally((function(){(null==n?void 0:n.esp_syncspinner)&&(Xrm.Utility.closeProgressIndicator(),t.clearFormNotification())}))];case 6:return(a=y.sent())?400!==a.status?[3,9]:(t.clearSyncNotifications(),l=(u=c.ErrorMessageResponse).fromJson,[4,a.text()]):[2];case 7:return s=l.apply(u,[y.sent()]),[4,r.ExceptionLowCodeButton.showFormNotificationGenericError(s.title,s.message)];case 8:return y.sent(),[2];case 9:return(null!==(h=a.status)&&void 0!==h?h:500)>=500?(t.clearSyncNotifications(),[4,a.text()]):[3,12];case 10:return f=null!==(b=y.sent())&&void 0!==b?b:"An error occurred on the server. Please try again later.",[4,r.ExceptionLowCodeButton.showFormNotificationGenericError("Error during HTTP Call","Error code: ".concat(a.status,"\n").concat(f))];case 11:return y.sent(),[2];case 12:return 200!==a.status?[3,19]:(t.clearSyncNotifications(),(null==n?void 0:n.esp_syncsuccessformnotification)?[4,t.showSuccessFormNotification()]:[3,14]);case 13:y.sent(),y.label=14;case 14:return(null==n?void 0:n.esp_syncconfirmationbox)?[4,t.openSuccessDialogSync()]:[3,16];case 15:y.sent(),y.label=16;case 16:return(null==n?void 0:n.esp_syncconfirmationboxredirect)?(m=(p=c.RedirectResponse).fromJson,[4,a.text()]):[3,18];case 17:d=m.apply(p,[y.sent()]),t.openSuccessDialogRedirect(d),y.label=18;case 18:t.reloadForm(),y.label=19;case 19:return[2]}}))}))},t}();e.ButtonRegistration=s}},e={},n=function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}(698);LCB=n})();