var LCB;(()=>{"use strict";var t={156:function(t,n,e){var i=this&&this.__createBinding||(Object.create?function(t,n,e,i){void 0===i&&(i=e);var o=Object.getOwnPropertyDescriptor(n,e);o&&!("get"in o?!n.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(t,i,o)}:function(t,n,e,i){void 0===i&&(i=e),t[i]=n[e]}),o=this&&this.__exportStar||function(t,n){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(n,e)||i(n,t,e)};Object.defineProperty(n,"__esModule",{value:!0}),o(e(939),n)},185:function(t,n,e){var i=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))((function(o,r){function a(t){try{u(i.next(t))}catch(t){r(t)}}function c(t){try{u(i.throw(t))}catch(t){r(t)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,c)}u((i=i.apply(t,n||[])).next())}))},o=this&&this.__generator||function(t,n){var e,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(e=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=n.call(t,r)}catch(t){c=[6,t],i=0}finally{e=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.Utils=void 0;var r=e(784),a=function(){function t(){}return t.getLanguageCode=function(){return Xrm.Utility.getGlobalContext().userSettings.languageId},t.getUserID=function(){return Xrm.Utility.getGlobalContext().userSettings.userId.replace("{","").replace("}","").toLowerCase()},t.getEntityLogicalName=function(t){return t.data.entity.getEntityName()},t.getRecordId=function(t){return t.data.entity.getId().replace("{","").replace("}","").toLowerCase()},t.getButtonSetting=function(n){return i(this,void 0,void 0,(function(){var e,i,r;return o(this,(function(o){switch(o.label){case 0:return e='\n        <fetch top="1">\n        <entity name="esp_buttonsettings">\n            <attribute name="esp_buttonsettingsid" />\n            <attribute name="esp_endpoint" />\n            <attribute name="esp_includecallinguserinpayload" />\n            <attribute name="esp_includeentitylogicalnameinpayload" />\n            <attribute name="esp_includerecordidinpayload" />\n            <attribute name="esp_name" />\n            <filter type="and">\n            <condition attribute="esp_name" operator="eq" value="'.concat(n,'" />\n            </filter>\n        </entity>\n        </fetch>\n    '),i="?fetchXml=".concat(encodeURIComponent(e)),r=Xrm.Utility.getGlobalContext().getClientUrl()+"/api/data/v9.1/esp_buttonsettingses"+i,[4,t.makeRequest("GET",r)];case 1:return[4,o.sent().json()];case 2:return[2,o.sent().value[0]]}}))}))},t.getButtonAdvancedSetting=function(n,e){return i(this,void 0,void 0,(function(){var i,r,a;return o(this,(function(o){switch(o.label){case 0:return i='\n      <fetch top="1">\n        <entity name="esp_buttonadvancedsetting">\n          <attribute name="esp_asyncformnotification" />\n          <attribute name="esp_asyncformnotificationtext" />\n          <attribute name="esp_buttonadvancedsettingid" />\n          <attribute name="esp_confirmationdialogcancellabel" />\n          <attribute name="esp_confirmationdialogconfirmlabel" />\n          <attribute name="esp_confirmationdialogsubtitle" />\n          <attribute name="esp_confirmationdialogtext" />\n          <attribute name="esp_confirmationdialogtitle" />\n          <attribute name="esp_executionmode" />\n          <attribute name="esp_mainbuttonsetting" />\n          <attribute name="esp_settingid" />\n          <attribute name="esp_settinglanguage" />\n          <attribute name="esp_showconfirmationdialog" />\n          <attribute name="esp_syncconfirmationbox" />\n          <attribute name="esp_syncconfirmationboxconfirmlabel" />\n          <attribute name="esp_syncconfirmationboxredirect" />\n          <attribute name="esp_syncconfirmationboxredirectcancellabel" />\n          <attribute name="esp_syncconfirmationboxredirectconfirmlabel" />\n          <attribute name="esp_syncconfirmationboxredirectmode" />\n          <attribute name="esp_syncconfirmationboxredirectsubtitle" />\n          <attribute name="esp_syncconfirmationboxredirecttext" />\n          <attribute name="esp_syncconfirmationboxredirecttitle" />\n          <attribute name="esp_syncconfirmationboxtext" />\n          <attribute name="esp_syncconfirmationboxtitle" />\n          <attribute name="esp_syncformnotification" />\n          <attribute name="esp_syncformnotificationtext" />\n          <attribute name="esp_syncrefreshform" />\n          <attribute name="esp_syncspinner" />\n          <attribute name="esp_syncspinnertext" />\n          <attribute name="esp_syncsuccessformnotification" />\n          <attribute name="esp_syncsuccessformnotificationtext" />\n          <filter>\n            <condition attribute="esp_mainbuttonsetting" operator="eq" value="'.concat(n,'" />\n          </filter>\n          <link-entity name="esp_language" from="esp_languageid" to="esp_settinglanguage" link-type="inner">\n            <filter>\n              <condition attribute="esp_lcid" operator="eq" value="').concat(e,'" />\n            </filter>\n          </link-entity>\n        </entity>\n      </fetch>\n    '),r="?fetchXml=".concat(encodeURIComponent(i)),a=Xrm.Utility.getGlobalContext().getClientUrl()+"/api/data/v9.1/esp_buttonadvancedsettings"+r,[4,t.makeRequest("GET",a)];case 1:return[4,o.sent().json()];case 2:return[2,o.sent().value[0]]}}))}))},t.makeRequest=function(t,n,e){return i(this,void 0,void 0,(function(){var i;return o(this,(function(o){return i={method:t,headers:{"Content-Type":"application/json","OData-MaxVersion":"4.0","OData-Version":"4.0",Accept:"application/json",Prefer:"odata.include-annotations=*"},body:e?JSON.stringify(e):void 0},[2,fetch(n,i)]}))}))},t.openConfirmationDialogBeforeRun=function(t){return i(this,void 0,void 0,(function(){var n,e,i,a,c;return o(this,(function(o){switch(o.label){case 0:return null!=t.esp_confirmationdialogtext?[3,2]:[4,r.ExceptionLowCodeButton.showConfirmationDialogError()];case 1:return o.sent(),[2];case 2:return n={cancelButtonLabel:null!==(e=t.esp_confirmationdialogcancellabel)&&void 0!==e?e:"",confirmButtonLabel:null!==(i=t.esp_confirmationdialogconfirmlabel)&&void 0!==i?i:"",subtitle:null!==(a=t.esp_confirmationdialogsubtitle)&&void 0!==a?a:"",text:null!==(c=t.esp_confirmationdialogtext)&&void 0!==c?c:"",title:t.esp_confirmationdialogtitle},[4,Xrm.Navigation.openConfirmDialog(n)];case 3:return[2,o.sent().confirmed]}}))}))},t.asyncFormNotification=function(t,n){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return null!=n.esp_asyncformnotificationtext?[3,2]:[4,r.ExceptionLowCodeButton.showFormNotificationMissingTextError()];case 1:return e.sent(),[2];case 2:return t.ui.setFormNotification(n.esp_asyncformnotificationtext,"INFO","LowCodeButtonAsyncNotification"),setTimeout((function(){t.ui.clearFormNotification("LowCodeButtonAsyncNotification")}),5e3),[2]}}))}))},t}();n.Utils=a},784:function(t,n){var e=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))((function(o,r){function a(t){try{u(i.next(t))}catch(t){r(t)}}function c(t){try{u(i.throw(t))}catch(t){r(t)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,c)}u((i=i.apply(t,n||[])).next())}))},i=this&&this.__generator||function(t,n){var e,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(e=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=n.call(t,r)}catch(t){c=[6,t],i=0}finally{e=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ExceptionLowCodeButton=void 0;var o=function(){function t(){}return t.buttonSettingNotFound=function(t){return e(this,void 0,void 0,(function(){var n;return i(this,(function(e){switch(e.label){case 0:return n={text:"Button setting not found: ".concat(t),title:"Button Setting Not Found"},[4,Xrm.Navigation.openAlertDialog(n)];case 1:return e.sent(),[2]}}))}))},t.buttonAdvancedSettingNotFound=function(t){return e(this,void 0,void 0,(function(){var n;return i(this,(function(e){switch(e.label){case 0:return n={text:"Button advanced setting not found for the LCID ".concat(t),title:"Button Advanced Setting Not Found"},[4,Xrm.Navigation.openAlertDialog(n)];case 1:return e.sent(),[2]}}))}))},t.showConfirmationDialogError=function(){return e(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t={text:"The confirmation dialog title is empty! Please fill it on your configuration settings.",title:"Confirmation Dialog Title Error"},[4,Xrm.Navigation.openAlertDialog(t)];case 1:return n.sent(),[2]}}))}))},t.showFormNotificationMissingTextError=function(){return e(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t={text:"The async form notification text is empty! Please fill it on your configuration settings.",title:"Async Form Notification Text Error"},[4,Xrm.Navigation.openAlertDialog(t)];case 1:return n.sent(),[2]}}))}))},t.showFormNotificationGenericError=function(t,n){return e(this,void 0,void 0,(function(){var e;return i(this,(function(i){switch(i.label){case 0:return e={text:n,title:t},[4,Xrm.Navigation.openAlertDialog(e)];case 1:return i.sent(),[2]}}))}))},t.clearFormNotification=function(t){return e(this,void 0,void 0,(function(){return i(this,(function(n){return t.ui.clearFormNotification("LowCodeButtonAsyncNotification"),[2]}))}))},t.noEndpointError=function(){return e(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t={text:"The endpoint is empty! Please fill it on your configuration settings.",title:"No Endpoint Error"},[4,Xrm.Navigation.openAlertDialog(t)];case 1:return n.sent(),[2]}}))}))},t}();n.ExceptionLowCodeButton=o},939:function(t,n,e){var i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},i.apply(this,arguments)},o=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))((function(o,r){function a(t){try{u(i.next(t))}catch(t){r(t)}}function c(t){try{u(i.throw(t))}catch(t){r(t)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,c)}u((i=i.apply(t,n||[])).next())}))},r=this&&this.__generator||function(t,n){var e,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(e=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=n.call(t,r)}catch(t){c=[6,t],i=0}finally{e=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ButtonRegistration=void 0;var a=e(784),c=e(185),u=function(){function t(){}return t.onClick=function(t,n){return o(this,void 0,void 0,(function(){var e,i,o,u;return r(this,(function(r){switch(r.label){case 0:return e=c.Utils.getLanguageCode(),[4,c.Utils.getButtonSetting(n)];case 1:return(i=r.sent())?[4,c.Utils.getButtonAdvancedSetting(null!==(u=i.esp_buttonsettingsid)&&void 0!==u?u:"",e)]:(a.ExceptionLowCodeButton.buttonSettingNotFound(n),[2]);case 2:return(o=r.sent())?[3,4]:[4,a.ExceptionLowCodeButton.buttonAdvancedSettingNotFound(e)];case 3:return r.sent(),[2];case 4:return o.esp_showconfirmationdialog?[4,c.Utils.openConfirmationDialogBeforeRun(o)]:[3,6];case 5:if(!r.sent())return[2];r.label=6;case 6:return[4,1===o.esp_executionmode?this.executeAsync(t,i,o):this.executeSync(t,i,o)];case 7:return r.sent(),[2]}}))}))},t.executeAsync=function(t,n,e){return o(this,void 0,void 0,(function(){var o;return r(this,(function(r){switch(r.label){case 0:return n.esp_endpoint?[3,2]:[4,a.ExceptionLowCodeButton.noEndpointError()];case 1:return r.sent(),[2];case 2:return e.esp_asyncformnotification?[4,c.Utils.asyncFormNotification(t,e)]:[3,4];case 3:r.sent(),r.label=4;case 4:return console.log("Executing async call to "+n.esp_endpoint),o={},n.esp_includeentitylogicalnameinpayload&&(o=i(i({},o),{entityLogicalName:c.Utils.getEntityLogicalName(t)})),n.esp_includerecordidinpayload&&(o=i(i({},o),{recordId:c.Utils.getRecordId(t)})),n.esp_includecallinguserinpayload&&(o=i(i({},o),{userId:c.Utils.getUserID()})),c.Utils.makeRequest("POST",n.esp_endpoint,o).catch((function(n){a.ExceptionLowCodeButton.showFormNotificationGenericError("Error during HTTP Call",n.message),a.ExceptionLowCodeButton.clearFormNotification(t)})),[2]}}))}))},t.executeSync=function(t,n,e){return o(this,void 0,void 0,(function(){return r(this,(function(t){return console.log("Executing sync call..."+n.esp_endpoint),[2]}))}))},t}();n.ButtonRegistration=u}},n={},e=function e(i){var o=n[i];if(void 0!==o)return o.exports;var r=n[i]={exports:{}};return t[i].call(r.exports,r,r.exports,e),r.exports}(156);LCB=e})();