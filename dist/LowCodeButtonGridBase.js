var LCB;(()=>{"use strict";var t={97:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{s(i.next(t))}catch(t){r(t)}}function c(t){try{s(i.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}s((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(t){c=[6,t],i=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseHelper=void 0;var r=n(842),a=function(){function t(){}return t.prototype.getButtonLocation=function(t){t&&("object"==typeof t.data?(this.formContext=t,this.containerType="form"):"function"==typeof t.getGrid&&(this.gridControl=t,"function"==typeof this.gridControl.getParent&&null!==this.gridControl.getParent()?this.containerType="subgrid":this.containerType="grid"))},t.prototype.getLanguageCode=function(){return Xrm.Utility.getGlobalContext().userSettings.languageId},t.prototype.getUserID=function(){return Xrm.Utility.getGlobalContext().userSettings.userId.replace("{","").replace("}","").toLowerCase()},t.prototype.getEntityPluralName=function(t){return i(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,Xrm.Utility.getEntityMetadata(t)];case 1:return[2,e.sent().EntitySetName]}}))}))},t.prototype.makeRequest=function(t,e,n){return i(this,void 0,void 0,(function(){var i;return o(this,(function(o){return i={method:t,headers:{"Content-Type":"application/json","OData-MaxVersion":"4.0","OData-Version":"4.0",Accept:"application/json",Prefer:"odata.include-annotations=*"},body:n?JSON.stringify(n):void 0},[2,fetch(e,i)]}))}))},t.prototype.getButtonSetting=function(t){return i(this,void 0,void 0,(function(){var e,n,i,a,c;return o(this,(function(o){switch(o.label){case 0:e='\n      <fetch top="1">\n        <entity name="esp_buttonsetting">\n          <attribute name="esp_buttonsettingid" />\n          <attribute name="esp_buttonlocation" />\n          <attribute name="esp_endpoint" />\n          <attribute name="esp_includecallinguseridinpayload" />\n          <attribute name="esp_includeentitylogicalnameinpayload" />\n          <attribute name="esp_includerecordidinpayload" />\n          <attribute name="esp_buttonname" />\n          <attribute name="esp_savebeforerunning" />\n          <attribute name="esp_refreshwhenapicallends" />\n          <filter type="and">\n            <condition attribute="esp_buttonname" operator="eq" value="'.concat(t,'" />\n          </filter>\n        </entity>\n      </fetch>\n    '),n="?fetchXml=".concat(encodeURIComponent(e)),i="".concat(Xrm.Utility.getGlobalContext().getClientUrl(),"/api/data/v9.1/esp_buttonsettings").concat(n),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.makeRequest("GET",i)];case 2:return[4,o.sent().json()];case 3:return a=o.sent(),c=a.value[0],this.buttonSetting=c,[2,c];case 4:return o.sent(),r.ExceptionLowCodeButton.buttonSettingNotFound(t),[2,null];case 5:return[2]}}))}))},t.prototype.getButtonAdvancedSetting=function(t,e){return i(this,void 0,void 0,(function(){var n,i,a,c,s;return o(this,(function(o){switch(o.label){case 0:n='\n      <fetch top="1">\n        <entity name="esp_buttonadvancedsetting">\n          <attribute name="esp_asyncformnotification" />\n          <attribute name="esp_asyncformnotificationtext" />\n          <attribute name="esp_buttonadvancedsettingid" />\n          <attribute name="esp_confirmationdialogcancellabel" />\n          <attribute name="esp_confirmationdialogconfirmlabel" />\n          <attribute name="esp_confirmationdialogsubtitle" />\n          <attribute name="esp_confirmationdialogtext" />\n          <attribute name="esp_confirmationdialogtitle" />\n          <attribute name="esp_executionmode" />\n          <attribute name="esp_mainbuttonsetting" />\n          <attribute name="esp_settingid" />\n          <attribute name="esp_settinglanguage" />\n          <attribute name="esp_showconfirmationdialog" />\n          <attribute name="esp_syncconfirmationbox" />\n          <attribute name="esp_syncconfirmationboxconfirmlabel" />\n          <attribute name="esp_syncconfirmationboxredirect" />\n          <attribute name="esp_syncconfirmationboxredirectcancellabel" />\n          <attribute name="esp_syncconfirmationboxredirectconfirmlabel" />\n          <attribute name="esp_syncconfirmationboxredirectmode" />\n          <attribute name="esp_syncconfirmationboxredirectsubtitle" />\n          <attribute name="esp_syncconfirmationboxredirecttext" />\n          <attribute name="esp_syncconfirmationboxredirecttitle" />\n          <attribute name="esp_syncconfirmationboxtext" />\n          <attribute name="esp_syncconfirmationboxtitle" />\n          <attribute name="esp_syncformnotification" />\n          <attribute name="esp_syncformnotificationtext" />\n          <attribute name="esp_syncrefreshform" />\n          <attribute name="esp_syncspinner" />\n          <attribute name="esp_syncspinnertext" />\n          <attribute name="esp_syncsuccessformnotification" />\n          <attribute name="esp_syncsuccessformnotificationtext" />\n          <filter>\n            <condition attribute="esp_mainbuttonsetting" operator="eq" value="'.concat(t,'" />\n          </filter>\n          <link-entity name="esp_language" from="esp_languageid" to="esp_settinglanguage" link-type="inner">\n            <filter>\n              <condition attribute="esp_lcid" operator="eq" value="').concat(e,'" />\n            </filter>\n          </link-entity>\n        </entity>\n      </fetch>\n    '),i="?fetchXml=".concat(encodeURIComponent(n)),a="".concat(Xrm.Utility.getGlobalContext().getClientUrl(),"/api/data/v9.1/esp_buttonadvancedsettings").concat(i),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this.makeRequest("GET",a)];case 2:return[4,o.sent().json()];case 3:return c=o.sent(),s=c.value[0],this.buttonAdvancedSetting=s,[2,s];case 4:return o.sent(),r.ExceptionLowCodeButton.buttonAdvancedSettingNotFound(e),[2,null];case 5:return[2]}}))}))},t.prototype.initializeSettings=function(t){return i(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return[4,this.getButtonSetting(t)];case 1:return(e=n.sent())?[4,this.getButtonAdvancedSetting(e.esp_buttonsettingid,this.getLanguageCode())]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t}();e.BaseHelper=a},180:function(t,e,n){var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)},a=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{s(i.next(t))}catch(t){r(t)}}function c(t){try{s(i.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}s((i=i.apply(t,e||[])).next())}))},c=this&&this.__generator||function(t,e){var n,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(t){c=[6,t],i=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonGridHelper=void 0;var s=n(842),u=function(t){function e(e){var n=t.call(this)||this;return n.getButtonLocation(e),n}return o(e,t),e.prototype.initializeSubgrid=function(){throw new Error("Method not implemented.")},e.prototype.getSelectedRecordIds=function(){if(!this.gridControl)throw new Error("Grid control is not set.");var t=this.gridControl.getGrid().getSelectedRows(),e=[];return t.forEach((function(t){e.push(t.data.entity.getId().replace("{","").replace("}","").toLowerCase())})),e},e.prototype.getEntityLogicalName=function(){if(!this.gridControl)throw new Error("Grid control is not set.");return this.gridControl.getEntityName()},e.prototype.validateSelection=function(){return a(this,void 0,void 0,(function(){return c(this,(function(t){if(!this.gridControl)throw new Error("Grid control is not set.");return 0===this.gridControl.getGrid().getSelectedRows().getLength()?(s.ExceptionLowCodeButton.displayGenericErrorNotification("No Records selected","No records selected. Please select at least one record."),[2,Promise.reject()]):[2,Promise.resolve()]}))}))},e.prototype.getPayload=function(){return a(this,void 0,void 0,(function(){var t,e,n,i,o;return c(this,(function(a){switch(a.label){case 0:if(!this.gridControl||!this.buttonSetting)throw new Error("Grid control or button setting is not set.");return t={},this.buttonSetting.esp_includeentitylogicalnameinpayload?(t=r(r({},t),{entityLogicalName:this.gridControl.getEntityName()}),e=[r({},t)],i={},[4,this.getEntityPluralName(this.getEntityLogicalName())]):[3,3];case 1:return t=r.apply(void 0,e.concat([(i.entityLogicalPluralName=a.sent(),i)])),"subgrid"!==this.containerType?[3,3]:(t=r(r({},t),{parentEntityLogicalName:this.getFormContextInSubgrid().data.entity.getEntityName()}),n=[r({},t)],o={},[4,this.getEntityPluralName(this.getFormContextInSubgrid().data.entity.getEntityName())]);case 2:t=r.apply(void 0,n.concat([(o.parentEntityLogicalPluralName=a.sent(),o)])),a.label=3;case 3:return this.buttonSetting.esp_includerecordidinpayload&&(t=r(r({},t),{recordIds:this.getSelectedRecordIds()}),"subgrid"===this.containerType&&(t=r(r({},t),{parentRecordId:this.getFormContextInSubgrid().data.entity.getId().replace("{","").replace("}","").toLowerCase()}))),this.buttonSetting.esp_includecallinguseridinpayload&&(t=r(r({},t),{userId:this.getUserID()})),[2,t]}}))}))},e.prototype.openConfirmationDialogBeforeRun=function(){return a(this,void 0,void 0,(function(){var t,e,n,i,o;return c(this,(function(r){switch(r.label){case 0:return this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_confirmationdialogtext?[3,2]:[4,s.ExceptionLowCodeButton.displayGenericErrorNotification("Confirmation Dialog Text Error","The confirmation dialog text is empty! Please fill it on your configuration settings.")];case 1:return r.sent(),[2,!1];case 2:return t={cancelButtonLabel:null!==(e=this.buttonAdvancedSetting.esp_confirmationdialogcancellabel)&&void 0!==e?e:"",confirmButtonLabel:null!==(n=this.buttonAdvancedSetting.esp_confirmationdialogconfirmlabel)&&void 0!==n?n:"",subtitle:null!==(i=this.buttonAdvancedSetting.esp_confirmationdialogsubtitle)&&void 0!==i?i:"",text:null!==(o=this.buttonAdvancedSetting.esp_confirmationdialogtext)&&void 0!==o?o:"",title:this.buttonAdvancedSetting.esp_confirmationdialogtitle},[4,Xrm.Navigation.openConfirmDialog(t)];case 3:return[2,r.sent().confirmed]}}))}))},e.prototype.asyncGridNotification=function(){return a(this,void 0,void 0,(function(){var t,e=this;return c(this,(function(n){switch(n.label){case 0:return this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_asyncformnotificationtext?[3,2]:[4,s.ExceptionLowCodeButton.displayGenericErrorNotification("Async Grid Notification Text Error","The async grid notification text is empty! Please fill it on your configuration settings.")];case 1:return n.sent(),[2];case 2:return t={level:4,message:this.buttonAdvancedSetting.esp_asyncformnotificationtext,type:2,showCloseButton:!0},Xrm.App.addGlobalNotification(t).then((function(t){e.globalNotificationId=t,setTimeout((function(){e.clearGridNotification()}),5e3)})),[2]}}))}))},e.prototype.clearGridNotification=function(){this.globalNotificationId&&(Xrm.App.clearGlobalNotification(this.globalNotificationId),this.globalNotificationId=void 0)},e.prototype.syncGridNotification=function(){return a(this,void 0,void 0,(function(){var t,e=this;return c(this,(function(n){switch(n.label){case 0:return this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_syncformnotificationtext?[3,2]:[4,s.ExceptionLowCodeButton.displayGenericErrorNotification("Sync Grid Notification Text Error","The sync grid notification text is empty! Please fill it on your configuration settings.")];case 1:return n.sent(),[2];case 2:return t={level:4,message:this.buttonAdvancedSetting.esp_syncformnotificationtext,type:2},Xrm.App.addGlobalNotification(t).then((function(t){e.globalNotificationId=t,setTimeout((function(){e.clearGridNotification()}),12e4)})),[2]}}))}))},e.prototype.clearSyncNotifications=function(){return a(this,void 0,void 0,(function(){var t,e;return c(this,(function(n){switch(n.label){case 0:return(null===(t=this.buttonAdvancedSetting)||void 0===t?void 0:t.esp_syncformnotification)?[4,this.clearGridNotification()]:[3,2];case 1:n.sent(),n.label=2;case 2:return(null===(e=this.buttonAdvancedSetting)||void 0===e?void 0:e.esp_syncspinner)&&Xrm.Utility.closeProgressIndicator(),[2]}}))}))},e.prototype.showSuccessGridNotification=function(){return a(this,void 0,void 0,(function(){var t,e=this;return c(this,(function(n){switch(n.label){case 0:return this.gridControl&&this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_syncsuccessformnotificationtext?[3,2]:[4,s.ExceptionLowCodeButton.displayGenericErrorNotification("Success Notification Text Error","The success notification text is empty! Please fill it on your configuration settings.\nField: esp_syncsuccessformnotificationtext")];case 1:return n.sent(),[2];case 2:return t={level:4,message:this.buttonAdvancedSetting.esp_syncsuccessformnotificationtext,type:2,showCloseButton:!0},Xrm.App.addGlobalNotification(t).then((function(t){e.globalNotificationId=t,setTimeout((function(){e.clearGridNotification()}),5e3)})),[2]}}))}))},e.prototype.openSuccessDialogSync=function(){return a(this,void 0,void 0,(function(){var t,e,n;return c(this,(function(i){switch(i.label){case 0:return this.buttonAdvancedSetting&&null!=this.buttonAdvancedSetting.esp_syncconfirmationboxtext?[3,2]:[4,s.ExceptionLowCodeButton.displayGenericErrorNotification("Sync Confirmation Box Text Error","The sync confirmation box text is empty! Please fill it on your configuration settings.")];case 1:return i.sent(),[2,!1];case 2:return t={confirmButtonLabel:null!==(e=this.buttonAdvancedSetting.esp_syncconfirmationboxconfirmlabel)&&void 0!==e?e:void 0,text:null!==(n=this.buttonAdvancedSetting.esp_syncconfirmationboxtext)&&void 0!==n?n:void 0,title:this.buttonAdvancedSetting.esp_syncconfirmationboxtitle},[4,Xrm.Navigation.openAlertDialog(t)];case 3:return[2,i.sent().confirmed]}}))}))},e.prototype.openSuccessDialogRedirect=function(t){var e,n,i,o,r=this;if(!this.buttonAdvancedSetting)throw new Error("Button advanced setting is not set.");if(null!=this.buttonAdvancedSetting.esp_syncconfirmationboxredirecttext){var a={cancelButtonLabel:null!==(e=this.buttonAdvancedSetting.esp_syncconfirmationboxredirectcancellabel)&&void 0!==e?e:void 0,confirmButtonLabel:null!==(n=this.buttonAdvancedSetting.esp_syncconfirmationboxredirectconfirmlabel)&&void 0!==n?n:void 0,text:this.buttonAdvancedSetting.esp_syncconfirmationboxredirecttext,subtitle:null!==(i=this.buttonAdvancedSetting.esp_syncconfirmationboxredirectsubtitle)&&void 0!==i?i:void 0,title:null!==(o=this.buttonAdvancedSetting.esp_syncconfirmationboxredirecttitle)&&void 0!==o?o:void 0};Xrm.Navigation.openConfirmDialog(a).then((function(e){e.confirmed?(console.log("User confirmed the dialog, redirecting..."),1===r.buttonAdvancedSetting.esp_syncconfirmationboxredirectmode?window.open(t.redirectUri,"_self").focus():window.open(t.redirectUri,"_blank").focus()):(console.log("User cancelled the dialog, refreshing the form."),r.reloadGrid())}))}else s.ExceptionLowCodeButton.displayGenericErrorNotification("Sync Confirmation Box Redirect Text Error","The sync confirmation box redirect text is empty! Please fill it on your configuration settings.")},e.prototype.reloadGrid=function(){if(!this.gridControl||!this.buttonSetting||!this.buttonAdvancedSetting)throw new Error("Required properties are not set for reloading the form.");!this.buttonSetting.esp_refreshwhenapicallends||this.buttonAdvancedSetting.esp_syncconfirmationboxredirect&&1===this.buttonAdvancedSetting.esp_syncconfirmationboxredirectmode||this.gridControl.refresh(),"subgrid"===this.containerType&&this.reloadForm()},e.prototype.reloadForm=function(){if(!this.formContext||!this.buttonSetting||!this.buttonAdvancedSetting||"subgrid"!==this.containerType)throw new Error("Required properties are not set for reloading the form.");!this.buttonSetting.esp_refreshwhenapicallends||this.buttonAdvancedSetting.esp_syncconfirmationboxredirect&&1===this.buttonAdvancedSetting.esp_syncconfirmationboxredirectmode||this.formContext.data.refresh(!1)},e.prototype.getFormContextInSubgrid=function(){return 789620002===this.buttonSetting.esp_buttonlocation&&"subgrid"===this.containerType?(console.log("Subgrid detected. Setting form context to parent form."),this.gridControl.formContext):null},e}(n(97).BaseHelper);e.ButtonGridHelper=u},331:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ErrorMessageResponse=e.RedirectResponse=void 0;var i=n(842),o=function(){function t(t){this.redirectUri=t}return t.fromJson=function(e){var n=JSON.parse(e);if("string"!=typeof n.redirectUri)throw i.ExceptionLowCodeButton.displayGenericErrorNotification("Redirect URI Not Found","The redirect URI was not found in the response."),new Error("Invalid JSON format for RedirectResponse");return new t(n.redirectUri)},t}();e.RedirectResponse=o;var r=function(){function t(t,e){this.message=t,this.title=e}return t.fromJson=function(e){var n,o=JSON.parse(e);if(console.log("Error message data",o),"string"!=typeof o.message)throw i.ExceptionLowCodeButton.displayGenericErrorNotification("Error Message Not Found","The error message was not found in the response."),new Error("Invalid JSON format for ErrorMessage");return new t(o.message,null!==(n=o.title)&&void 0!==n?n:"")},t}();e.ErrorMessageResponse=r},834:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{s(i.next(t))}catch(t){r(t)}}function c(t){try{s(i.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}s((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(t){c=[6,t],i=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonRegistrationGrid=void 0;var r=n(842),a=n(180),c=n(331),s=function(){function t(){}return t.onClick=function(t,e){return i(this,void 0,void 0,(function(){var n;return o(this,(function(i){switch(i.label){case 0:return[4,(n=new a.ButtonGridHelper(t)).initializeSettings(e)];case 1:return i.sent(),[4,n.validateSelection()];case 2:return i.sent()?[2]:n.buttonAdvancedSetting.esp_showconfirmationdialog?[4,n.openConfirmationDialogBeforeRun()]:[3,4];case 3:if(!i.sent())return[2];i.label=4;case 4:return n.buttonSetting.esp_endpoint?[3,6]:[4,r.ExceptionLowCodeButton.displayGenericErrorNotification("Endpoint Not Set","The endpoint for the button is not set. Please set it up in the button settings.")];case 5:return i.sent(),[2];case 6:return 1!==n.buttonAdvancedSetting.esp_executionmode?[3,8]:[4,this.executeAsync(n)];case 7:return i.sent(),[3,10];case 8:return[4,this.executeSync(n)];case 9:i.sent(),i.label=10;case 10:return[2]}}))}))},t.executeAsync=function(t){return i(this,void 0,void 0,(function(){var e,n,a,c,s,u=this;return o(this,(function(l){switch(l.label){case 0:return e=t.buttonSetting,n=t.buttonAdvancedSetting,console.log("Executing async call to ".concat(null==e?void 0:e.esp_endpoint)),(null==n?void 0:n.esp_asyncformnotification)&&t.asyncGridNotification(),c=(a=t).makeRequest,s=["POST",e.esp_endpoint],[4,t.getPayload()];case 1:return c.apply(a,s.concat([l.sent()])).catch((function(t){return i(u,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,r.ExceptionLowCodeButton.displayGenericErrorNotification("Error during HTTP Call",t.message)];case 1:return e.sent(),[2]}}))}))})),[2]}}))}))},t.executeSync=function(t){return i(this,void 0,void 0,(function(){var e,n,a,s,u,l,d,f,p,h,b,g,y,m,v,x=this;return o(this,(function(_){switch(_.label){case 0:return e=t.buttonSetting,n=t.buttonAdvancedSetting,console.log("Executing sync call to ".concat(null==e?void 0:e.esp_endpoint)),(null==n?void 0:n.esp_syncformnotification)?[4,t.syncGridNotification()]:[3,2];case 1:_.sent(),_.label=2;case 2:return(null==n?void 0:n.esp_syncspinner)?n.esp_syncspinnertext?[3,4]:[4,r.ExceptionLowCodeButton.displayGenericErrorNotification("Sync Spinner Text Error","The sync spinner text is empty! Please fill it on your configuration settings.")]:[3,5];case 3:return _.sent(),[2];case 4:Xrm.Utility.showProgressIndicator(n.esp_syncspinnertext),_.label=5;case 5:return u=(s=t).makeRequest,l=["POST",e.esp_endpoint],[4,t.getPayload()];case 6:return[4,u.apply(s,l.concat([_.sent()])).catch((function(t){return i(x,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,r.ExceptionLowCodeButton.displayGenericErrorNotification("Error during HTTP Call",t.message)];case 1:return e.sent(),[2]}}))}))})).finally((function(){(null==n?void 0:n.esp_syncspinner)&&Xrm.Utility.closeProgressIndicator(),(null==n?void 0:n.esp_syncformnotification)&&t.clearGridNotification()}))];case 7:return(a=_.sent())?400!==a.status?[3,10]:(p=(f=c.ErrorMessageResponse).fromJson,[4,a.text()]):[2];case 8:return d=p.apply(f,[_.sent()]),[4,r.ExceptionLowCodeButton.displayGenericErrorNotification(d.title,d.message)];case 9:return _.sent(),[2];case 10:return(null!==(m=a.status)&&void 0!==m?m:500)>=500?[4,a.text()]:[3,13];case 11:return h=null!==(v=_.sent())&&void 0!==v?v:"An error occurred on the server. Please try again later.",[4,r.ExceptionLowCodeButton.displayGenericErrorNotification("Error during HTTP Call","Error code: ".concat(a.status,"\n").concat(h))];case 12:return _.sent(),[2];case 13:return 200!==a.status?[3,20]:(t.clearSyncNotifications(),(null==n?void 0:n.esp_syncsuccessformnotification)?[4,t.showSuccessGridNotification()]:[3,15]);case 14:_.sent(),_.label=15;case 15:return(null==n?void 0:n.esp_syncconfirmationbox)?[4,t.openSuccessDialogSync()]:[3,17];case 16:_.sent(),_.label=17;case 17:return(null==n?void 0:n.esp_syncconfirmationboxredirect)?(y=(g=c.RedirectResponse).fromJson,[4,a.text()]):[3,19];case 18:b=y.apply(g,[_.sent()]),t.openSuccessDialogRedirect(b),_.label=19;case 19:t.reloadGrid(),_.label=20;case 20:return[2]}}))}))},t}();e.ButtonRegistrationGrid=s},842:function(t,e){var n=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{s(i.next(t))}catch(t){r(t)}}function c(t){try{s(i.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}s((i=i.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,i,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(t){c=[6,t],i=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.ExceptionLowCodeButton=void 0;var o=function(){function t(){}return t.buttonSettingNotFound=function(t){return n(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e={text:"Button setting not found: ".concat(t),title:"Button Setting Not Found"},[4,Xrm.Navigation.openAlertDialog(e)];case 1:return n.sent(),[2]}}))}))},t.buttonAdvancedSettingNotFound=function(t){return n(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return e={text:"Button advanced setting not found for the LCID ".concat(t),title:"Button Advanced Setting Not Found"},[4,Xrm.Navigation.openAlertDialog(e)];case 1:return n.sent(),[2]}}))}))},t.displayGenericErrorNotification=function(t,e){return n(this,void 0,void 0,(function(){var n;return i(this,(function(i){switch(i.label){case 0:return n={text:e,title:t},[4,Xrm.Navigation.openAlertDialog(n)];case 1:return i.sent(),[2]}}))}))},t}();e.ExceptionLowCodeButton=o}},e={},n=function n(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}(834);LCB=n})();